{"version":3,"sources":["../../../src/components/Form/SearchForm.js"],"names":["SearchForm","props","context","formRef","React","createRef","state","expand","action","onSearch","console","warn","current","getFieldsValue","invokeSearch","resetFields","onReset","nextExpand","setState","children","showItem","slice","min","extendText","expandText","collapseText","text","length","icon","marginRight","fontSize","toggle","bind","queryText","resetText","cols","compact","gutter","actions","style","renderItems","renderExtend","handleSearch","handleReset","PureComponent","defaultProps","propTypes","PropTypes","func","isRequired","number","string","bool","any"],"mappings":"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","file":"SearchForm.js","sourcesContent":["/**\r\n * SearchForm\r\n * Created by pengj on 2018-4-29.\r\n */\r\nimport React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { Button, Col, Form, Icon } from \"antd\";\r\nimport isFunction from \"lodash/isFunction\";\r\nimport isArray from \"lodash/isArray\";\r\nimport {\r\n  UpSquareOutlined,\r\n  DownSquareOutlined,\r\n  SearchOutlined,\r\n  ReloadOutlined,\r\n} from \"@ant-design/icons\";\r\nimport FormLayout from \"./FormLayout\";\r\n\r\n/**\r\n * 自动布局查询表单,  可以通过min调整, 提供高级搜索能力\r\n *\r\n * ```\r\n * <SearchForm cols={4} min={2} actions={ <Button>测试</Button> } form={form} onSearch={(data) => {console.log(data);}}>\r\n *   {this.renderItem1()}\r\n * </SearchForm>\r\n * ```\r\n */\r\nexport default class SearchForm extends React.PureComponent {\r\n  static defaultProps = {\r\n    min: 999,\r\n    queryText: \"查询\",\r\n    resetText: \"清除\",\r\n    expandText: \"更多条件\",\r\n    collapseText: \"简化条件\",\r\n    compact: true,\r\n    cols: 3,\r\n  };\r\n\r\n  static propTypes = {\r\n    /**\r\n     * 查询函数   (values,event:{action}) => {}, event.action 触发动作 查询(SEARCH)或者重置(RESET)\r\n     */\r\n    onSearch: PropTypes.func.isRequired,\r\n\r\n    /**\r\n     * 点击重置后触发,  会在onSearch之前执行,    重置会触发一次onSearch(空值)\r\n     */\r\n    onReset: PropTypes.func,\r\n\r\n    /**\r\n     * 精简模式下展示多少条件\r\n     */\r\n    min: PropTypes.number,\r\n\r\n    /**\r\n     * 查询按钮文字\r\n     */\r\n    queryText: PropTypes.string,\r\n\r\n    /**\r\n     * 重置按钮文字\r\n     */\r\n    resetText: PropTypes.string,\r\n\r\n    /**\r\n     * 展开按钮文字\r\n     */\r\n    expandText: PropTypes.string,\r\n\r\n    /**\r\n     * 收缩按钮文字\r\n     */\r\n    collapseText: PropTypes.string,\r\n\r\n    /**\r\n     * 布局展示几行  FormLayout cols\r\n     */\r\n    cols: PropTypes.number,\r\n\r\n    /**\r\n     * 是否紧缩布局   FormLayout compact\r\n     */\r\n    compact: PropTypes.bool,\r\n\r\n    /**\r\n     * FormLayout gutter\r\n     */\r\n    gutter: PropTypes.number,\r\n\r\n    /**\r\n     * 放置在查询按钮后的 扩展按钮\r\n     */\r\n    actions: PropTypes.any,\r\n\r\n    /**\r\n     * style\r\n     */\r\n    style: PropTypes.any,\r\n  };\r\n\r\n  constructor(props, context) {\r\n    super(props, context);\r\n    this.formRef = React.createRef();\r\n\r\n    // if (!this.form) {\r\n    //   console.warn(\"props.form must be return from  Form.useForm\");\r\n    // }\r\n\r\n    this.state = {\r\n      expand: false,\r\n    };\r\n  }\r\n\r\n  invokeSearch(action) {\r\n    const { onSearch } = this.props;\r\n\r\n    if (!isFunction(onSearch)) {\r\n      console.warn(\"onSearch must be function\");\r\n    } else {\r\n      onSearch(this.formRef.current.getFieldsValue(), { action });\r\n    }\r\n  }\r\n\r\n  handleSearch() {\r\n    this.invokeSearch(\"SEARCH\");\r\n  }\r\n\r\n  handleReset() {\r\n    this.formRef.current.resetFields();\r\n\r\n    const { onReset } = this.props;\r\n    if (isFunction(onReset)) {\r\n      onReset();\r\n    }\r\n\r\n    this.invokeSearch(\"RESET\");\r\n  }\r\n\r\n  toggle() {\r\n    const {\r\n      state: { expand },\r\n    } = this;\r\n\r\n    const nextExpand = !expand;\r\n    if (!nextExpand) {\r\n      this.formRef.current.resetFields();\r\n    }\r\n\r\n    this.setState({ expand: nextExpand });\r\n  }\r\n\r\n  renderItems() {\r\n    const { expand } = this.state;\r\n    let { children } = this.props;\r\n    if (!isArray(children)) {\r\n      children = [children];\r\n    }\r\n\r\n    let showItem = [];\r\n    if (expand) {\r\n      showItem = children;\r\n    } else {\r\n      showItem = children.slice(0, this.props.min);\r\n    }\r\n\r\n    return showItem;\r\n  }\r\n\r\n  renderExtend(expand) {\r\n    const { children, extendText, min, expandText, collapseText } = this.props;\r\n\r\n    const text = expand ? collapseText : extendText || expandText;\r\n\r\n    if (children.length > min) {\r\n      const icon = expand ? <UpSquareOutlined /> : <DownSquareOutlined />;\r\n\r\n      return (\r\n        <a\r\n          style={{ marginRight: 12, fontSize: 12 }}\r\n          onClick={this.toggle.bind(this)}\r\n        >\r\n          {text} {icon}\r\n        </a>\r\n      );\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const { expand } = this.state;\r\n    const {\r\n      queryText,\r\n      resetText,\r\n      cols,\r\n      compact,\r\n      gutter,\r\n      actions,\r\n      style,\r\n    } = this.props;\r\n\r\n    return (\r\n      <Form className=\"antd-x-search-form\" style={style} ref={this.formRef}>\r\n        <FormLayout cols={cols} compact={compact} gutter={gutter}>\r\n          {this.renderItems()}\r\n          <Col className=\"actions\" nowarp={true}>\r\n            {this.renderExtend(expand)}\r\n            <Button\r\n              type=\"primary\"\r\n              icon={<SearchOutlined />}\r\n              onClick={this.handleSearch.bind(this)}\r\n            >\r\n              {queryText}\r\n            </Button>\r\n            <Button\r\n              icon={<ReloadOutlined />}\r\n              onClick={this.handleReset.bind(this)}\r\n            >\r\n              {resetText}\r\n            </Button>\r\n            {actions}\r\n          </Col>\r\n        </FormLayout>\r\n      </Form>\r\n    );\r\n  }\r\n}\r\n"]}